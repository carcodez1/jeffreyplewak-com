%%{init:{  "theme":"base",  "themeVariables":{    "fontFamily":"Helvetica Neue, Arial, sans-serif",    "primaryTextColor":"#1f2937",    "lineColor":"#6b7280"  }}}%%flowchart TBTITLE["KProveEngine Enterprise Architecture (2026)\nDeterministic AI Governance Platform"]%% =========================%% IDENTITY DOMAIN%% =========================subgraph ID["IDENTITY & ACCESS DOMAIN"]    A["Identity Provider (IdP)"]    B["Authentication / Authorization"]    C["Role-Based Access Control"]    D["Access Audit Log"]    A --> B --> C --> Dend%% =========================%% LOCAL CONTROLLED ENVIRONMENT%% =========================subgraph LOCAL["LOCAL CONTROLLED EXECUTION ENVIRONMENT"]    E["Client Submission"]    F["Input Validation & Data Classification"]    G["Deterministic Core Pipeline"]    H["Inference Configuration Snapshot"]    I["Structured Output Layer"]    E --> F --> G --> I    G --> Hend%% =========================%% AGENT ORCHESTRATION%% =========================subgraph AGENT["AGENT ORCHESTRATION LAYER (Policy-Constrained)"]    J["Task Orchestrator"]    K["Priority Scheduler\n(Prevents Inversion)"]    L["Agent Execution Sandbox"]    M["Escalation Controller"]    J --> K --> L    K --> MendI --> JL --> I%% =========================%% CLOUD PROVIDER%% =========================subgraph CLOUD["CLOUD MODEL PROVIDER (Untrusted Boundary)"]    N["External LLM Service"]endG --> NL --> N%% =========================%% CRYPTOGRAPHIC INTEGRITY%% =========================subgraph INTEGRITY["CRYPTOGRAPHIC INTEGRITY CONTROLS"]    O["SHA-256 Content Hashing"]    P["Manifest Generation"]    Q["Provenance Record\n(Model + Prompt + Runtime)"]endI --> O --> PH --> Q --> P%% =========================%% GOVERNANCE DOMAIN%% =========================subgraph GOV["GOVERNANCE & POLICY DOMAIN"]    R["Policy Engine"]    S{"Human Review Required?"}    T["Human Review Record"]    U["Immutable Audit Log"]    P --> R    R --> S    S -->|Yes| T --> U    S -->|No| UendR --> JR --> K%% =========================%% CI/CD & SUPPLY CHAIN%% =========================subgraph CICD["CI/CD & SUPPLY CHAIN INTEGRITY"]    V["Version-Controlled Repository"]    W["Build Pipeline (SLSA-Aligned)"]    X["Artifact Signing"]    Y["Software Bill of Materials (SBOM)"]    V --> W --> X --> YendW --> G%% =========================%% EVIDENCE & RETENTION%% =========================subgraph OUTPUT["VERIFIABLE OUTPUT & RETENTION"]    Z["Signed Evidence Bundle"]    AA["Trusted Timestamp Authority"]    AB["Secure Object Storage"]    U --> Z --> AA --> ABend%% Flow from IdentityC --> ETITLE --> A%% =========================%% STYLING%% =========================classDef title fill:#e5e7eb,stroke:#6b7280,color:#111827,stroke-width:2px;classDef identity fill:#1e3a8a,stroke:#1d4ed8,color:#ffffff,stroke-width:2px;classDef local fill:#0f766e,stroke:#0d9488,color:#ffffff,stroke-width:2px;classDef agent fill:#0c4a6e,stroke:#0891b2,color:#ffffff,stroke-width:2px;classDef cloud fill:#6b7280,stroke:#9ca3af,color:#ffffff,stroke-width:2px,stroke-dasharray:5 5;classDef integrity fill:#92400e,stroke:#d97706,color:#ffffff,stroke-width:2px;classDef governance fill:#5b21b6,stroke:#7c3aed,color:#ffffff,stroke-width:2px;classDef cicd fill:#374151,stroke:#4b5563,color:#ffffff,stroke-width:2px;classDef output fill:#065f46,stroke:#10b981,color:#ffffff,stroke-width:2px;class TITLE title;class A,B,C,D identity;class E,F,G,H,I local;class J,K,L,M agent;class N cloud;class O,P,Q integrity;class R,S,T,U governance;class V,W,X,Y cicd;class Z,AA,AB output;